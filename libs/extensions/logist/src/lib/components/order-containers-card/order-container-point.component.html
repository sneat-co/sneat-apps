<ion-grid class="ion-grid-layout">
	<ion-row>
		<ion-col size="4">
			<ion-item color="light">
				<ion-label style="font-weight: bold"
					>{{ shippingPoint?.counterparty?.title }} &#64;
					{{ shippingPoint?.location?.title }}</ion-label
				>
			</ion-item>
		</ion-col>
		<ion-col size="3">
			<ion-item color="light">
				<ion-label>Ref #</ion-label>
				<ion-input
					type="text"
					maxlength="50"
					[formControl]="refNumber"
					[disabled]="saving"
					(keyup.enter)="saveRefNumber($event)"
					(keyup.escape)="cancelRefNumberChanges()"
				/>
				@if (refNumber.dirty) {
					<ion-buttons slot="end">
						@if (!saving) {
							<ion-button
								(click)="cancelRefNumberChanges()"
								[disabled]="saving"
							>
								<ion-icon name="close-outline" slot="start" />
								<ion-label>Cancel</ion-label>
							</ion-button>
						}
						<ion-button
							color="primary"
							fill="solid"
							(click)="saveRefNumber($event)"
							[disabled]="saving"
						>
							@if (!saving) {
								<ion-icon slot="start" name="save-outline" />
							}
							@if (saving) {
								<ion-spinner slot="start" name="lines-small" />
							}
							@if (!saving) {
								<ion-label>Save</ion-label>
							}
							@if (saving) {
								<ion-label>Saving...</ion-label>
							}
						</ion-button>
					</ion-buttons>
				}
			</ion-item>
		</ion-col>
		<ion-col size="4">
			<ion-item color="light">
				<ion-segment [(ngModel)]="dateTimeTab">
					<ion-segment-button value="scheduled">
						<ion-label color="medium">Scheduled</ion-label>
					</ion-segment-button>
					<ion-segment-button value="actual">
						<ion-label color="medium">Actual</ion-label>
					</ion-segment-button>
					<ion-segment-button value="notes">
						<ion-label color="medium">Notes</ion-label>
					</ion-segment-button>
				</ion-segment>
			</ion-item>
		</ion-col>
		<ion-col size="1">
			<ion-item color="light">
				<ion-buttons slot="end">
					<ion-button color="medium" (click)="delete($event)" title="Delete">
						<ion-icon name="trash-outline" slot="end" />
						<!--						<ion-label>Delete</ion-label>-->
					</ion-button>
				</ion-buttons>
			</ion-item>
		</ion-col>
	</ion-row>
</ion-grid>

@if (!showNotes) {
	<sneat-container-endpoint
		endpointSide="arrival"
		[space]="space"
		[order]="order"
		[shippingPointID]="shippingPoint?.id"
		[dateTimeTab]="dateTimeTab"
		[containerPoint]="containerPoint"
	/>
	<sneat-container-endpoint
		endpointSide="departure"
		[space]="space"
		[order]="order"
		[shippingPointID]="shippingPoint?.id"
		[dateTimeTab]="dateTimeTab"
		[containerPoint]="containerPoint"
	/>
	<sneat-container-point-load-form
		[order]="order"
		[task]="'load'"
		[shippingPoint]="shippingPoint"
		[containerPoint]="containerPoint"
	/>
	<sneat-container-point-load-form
		[order]="order"
		[task]="'unload'"
		[shippingPoint]="shippingPoint"
		[containerPoint]="containerPoint"
	/>
}

@if (showNotes) {
	<ion-item-group>
		<!-- Notes -->
		<ion-item-divider>
			<ion-label>Notes</ion-label>
			@if (notes.dirty) {
				<ion-buttons slot="end">
					@if (!saving) {
						<ion-button (click)="cancelNotesChanges()" [disabled]="saving">
							<ion-icon name="close-outline" slot="start" />
							<ion-label>Cancel</ion-label>
						</ion-button>
					}
					<ion-button
						color="primary"
						fill="solid"
						(click)="saveNotes($event)"
						[disabled]="saving"
					>
						@if (!saving) {
							<ion-icon slot="start" name="save-outline" />
						}
						@if (saving) {
							<ion-spinner slot="start" name="lines-small" />
						}
						@if (!saving) {
							<ion-label>Save</ion-label>
						}
						@if (saving) {
							<ion-label>Saving...</ion-label>
						}
					</ion-button>
				</ion-buttons>
			}
		</ion-item-divider>
		<ion-item>
			<ion-textarea
				placeholder="Your notes for trucker"
				maxlength="1000"
				[autoGrow]="true"
				[formControl]="notes"
				(ionChange)="onSpecialInstructionsChanged()"
				(keyup.enter)="saveNotes($event)"
				(keyup.escape)="cancelNotesChanges()"
			/>
		</ion-item>
	</ion-item-group>
}
<!-- End of Special instructions -->
